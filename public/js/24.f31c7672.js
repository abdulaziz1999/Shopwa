(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[24],{"29d2":function(t,s,n){"use strict";n.r(s);var i=function(){var t=this,s=t.$createElement,n=t._self._c||s;return n("q-page",{staticClass:"q-pa-sm"},[n("q-header",{staticClass:"text-primary bg-white",attrs:{reveal:"","reveal-offset":10}},[n("q-toolbar",[n("q-btn",{attrs:{flat:"",round:"",dense:"",icon:"arrow_back"},on:{click:t.handleBackButton}}),n("q-toolbar-title",{staticClass:"text-weight-bold brand"},[t._v("Checkout")])],1)],1),t.carts&&t.carts.length?n("div",{ref:"top",staticClass:"q-pb-xl",attrs:{id:"checkout"}},[n("shipping-address",{attrs:{isModalAddress:t.isAvailableOldAddress,formData:t.form},on:{place:t.placeAddress,closeModal:function(s){t.isAvailableOldAddress=!1}}})],1):t._e(),n("q-inner-loading",{attrs:{showing:t.loading}},[n("q-spinner-facebook",{attrs:{size:"50px",color:"primary"}})],1),n("q-footer",{staticClass:"bg-white q-pa-md"},[n("q-btn",{staticClass:"full-width",attrs:{disabled:!t.isOk,"no-caps":"",unelevated:"",label:"Proses Pesanan",color:"primary"},on:{click:t.directChekout}})],1)],1)},o=[],e=(n("159b"),n("99af"),n("b0c0"),n("ac1f"),n("5319"),n("2ca0"),n("13d5"),n("1276"),n("a15b"),n("54df")),r={components:{ShippingAddress:e["a"]},name:"DirectWithShipping",data:function(){return{isAvailableOldAddress:!1,isOk:!1,formLoading:!1,form:{reference:"",customer_name:"",customer_email:"",customer_whatsapp:"",address:"",items:[],subtotal:0,total:0,quantity:0,weight:0,shipping_courier_name:"COD",shipping_cost:"",shipping_courier_service:""}}},computed:{carts:function(){return this.$store.state.cart.carts},shop:function(){return this.$store.state.shop},config:function(){return this.$store.state.config},loading:function(){return this.$store.state.loading},session_id:function(){return this.$store.state.session_id},coupon_discount:function(){return this.$store.state.coupon.coupon_discount}},mounted:function(){this.carts.length||this.$router.back(),this.checkDataUser()},methods:{placeAddress:function(t){this.form.user_id=t.user_id,this.form.customer_email=t.customer_email,this.form.customer_name=t.customer_name,this.form.customer_whatsapp=t.customer_whatsapp,this.form.shipping_cost=t.shipping_cost,this.form.shipping_courier_name=t.shipping_courier_name,this.form.shipping_courier_service=t.shipping_courier_service,this.form.address=t.address,this.checkDiscount(),this.collectOrder(),this.checkStepOk()},collectOrder:function(){this.form.items=this.carts,this.form.subtotal=this.sumSubtotal(),this.form.total=this.sumGrandTotal(),this.form.quantity=this.sumQty(),this.form.weight=this.sumWeight(),this.coupon_discount&&(this.form.coupon_discount=this.getDiscountAmount())},checkDiscount:function(){this.coupon_discount&&(this.form.coupon_discount=this.getDiscountAmount())},checkDataUser:function(){localStorage.getItem("user_data")&&(this.isAvailableOldAddress=!0)},handleBackButton:function(){this.$router.push({name:"Cart"})},toTop:function(){var t=this;setTimeout((function(){var s=t.$refs.top;s.scrollIntoView({behavior:"smooth"})}),500)},checkStepOk:function(){this.form.customer_name&&this.form.customer_whatsapp&&this.form.shipping_courier_name&&this.form.address?this.isOk=!0:this.isOk=!1},directChekout:function(){var t=this;if(this.checkStepOk(),this.isOk){var s="https://api.whatsapp.com",n=this.formatPhoneNumber(this.shop.phone),i="Halo kak, saya mau order:\n\n",o=this.carts,e=1;o.forEach((function(s){i+="*".concat(e,". ").concat(s.name,"*\n"),s.note&&(i+="[".concat(s.note,"]\n")),i+="Jumlah: ".concat(s.quantity,"\nHarga (@): ").concat(t.moneyIDR(s.price),"\nHarga Total: ").concat(t.moneyIDR(s.quantity*s.price),"\n\n"),e++})),i+="Subtotal: *".concat(this.moneyIDR(this.subtotal()),"*\nOngkir: *").concat(this.moneyIDR(this.form.shipping_cost),"*\nDiskon: *").concat(this.moneyIDR(this.getDiscountAmount()),"*\nTotal: *").concat(this.moneyIDR(this.total()),"*\n-----------------------------------\n\n*Nama:*\n ").concat(this.form.customer_name," (").concat(this.form.customer_whatsapp,")\n\n*Alamat:*\n").concat(this.formatAddressCod(this.form.address),"\n\nKurir: ").concat(this.form.shipping_courier_name,"\nServis: ").concat(this.form.shipping_courier_service,"\n");var r=s+"/send?phone="+n+"&text="+encodeURI(i);setTimeout((function(){t.$router.push({name:"Cart"})}),1e3),setTimeout((function(){t.$store.dispatch("cart/clearCart",t.session_id)}),5e3),window.open(r,"_blank")}},formatPhoneNumber:function(t){var s=t.replace(/\D/g,"");return s.startsWith("0")&&(s="62"+s.substr(1)),s},subtotal:function(){if(this.carts.length>1){var t=[];return this.carts.forEach((function(s){t.push(s.quantity*s.price)})),t.reduce((function(t,s){return t+s}))}return this.carts[0].quantity*this.carts[0].price},total:function(){return this.subtotal()+this.form.shipping_cost},money:function(t){return new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR"}).format(t)},formatAddressCod:function(t){var s=t.split("<br>");return s.join("\n")},getDiscountPercent:function(){return this.coupon_discount?"percent"==this.coupon_discount.discount.unit?parseInt(this.coupon_discount.discount.value):parseInt(this.coupon_discount.discount.value)/parseInt(this.sumSubtotal())*100:0},getDiscountAmount:function(){return this.coupon_discount?"percent"==this.coupon_discount.discount.unit?parseInt(this.coupon_discount.discount.value)/100*parseInt(this.sumSubtotal()):parseInt(this.coupon_discount.discount.value):0},sumQty:function(){if(this.carts.length>1){var t=[];return this.carts.forEach((function(s){t.push(parseInt(s.quantity))})),t.reduce((function(t,s){return t+s}))}return parseInt(this.carts[0].quantity)},sumSubtotal:function(){if(this.carts.length>1){var t=[];return this.carts.forEach((function(s){t.push(parseInt(s.quantity)*parseInt(s.price))})),t.reduce((function(t,s){return t+s}))}return parseInt(this.carts[0].quantity)*parseInt(this.carts[0].price)},sumGrandTotal:function(){return this.coupon_discount?this.sumSubtotal()-this.getDiscountAmount()+parseInt(this.form.shipping_cost):this.sumSubtotal()+parseInt(this.form.shipping_cost)},sumWeight:function(){if(this.carts.length>1){var t=[];return this.carts.forEach((function(s){t.push(parseInt(s.weight)*parseInt(s.quantity))})),t.reduce((function(t,s){return t+s}))}return parseInt(this.carts[0].quantity)*parseInt(this.carts[0].weight)}}},a=r,c=n("2877"),u=n("9989"),h=n("e359"),p=n("65c6"),m=n("9c40"),d=n("6ac5"),l=n("74f7"),f=n("e669"),_=n("7ff0"),g=n("eebe"),b=n.n(g),k=Object(c["a"])(a,i,o,!1,null,null,null);s["default"]=k.exports;b()(k,"components",{QPage:u["a"],QHeader:h["a"],QToolbar:p["a"],QBtn:m["a"],QToolbarTitle:d["a"],QInnerLoading:l["a"],QSpinnerFacebook:f["a"],QFooter:_["a"]})}}]);