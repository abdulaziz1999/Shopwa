(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[47],{ba30:function(t,a,e){"use strict";e.r(a);var i=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("q-page",[e("q-header",[e("q-toolbar",[e("q-btn",{directives:[{name:"go-back",rawName:"v-go-back.single",modifiers:{single:!0}}],attrs:{flat:"",round:"",dense:"",icon:"arrow_back"}}),e("q-toolbar-title",[t._v("\n       Edit Produk\n      ")]),t.form.variants.length?t._e():e("q-btn",{attrs:{flat:"",icon:"add",label:"Produk Variasi"},on:{click:t.handleAddVariant}})],1)],1),e("q-form",{on:{submit:function(a){return a.preventDefault(),t.submit(a)}}},[e("div",{staticClass:"q-pa-md q-gutter-y-sm"},[e("q-input",{attrs:{filled:"",type:"text",label:"Nama Produk",rules:[function(t){return t&&""!=t||"Nama produk harus diisi"}]},model:{value:t.form.title,callback:function(a){t.$set(t.form,"title",a)},expression:"form.title"}}),e("div",{staticClass:"row items-center q-gutter-x-sm"},[e("div",{staticClass:"col"},[e("q-input",{attrs:{filled:"",mask:"#########",label:"Harga",rules:t.requiredRules},model:{value:t.form.price,callback:function(a){t.$set(t.form,"price",a)},expression:"form.price"}})],1),e("div",{staticClass:"col"},[e("q-input",{attrs:{filled:"",mask:"#####",label:"Stok",rules:t.requiredRules},model:{value:t.form.stock,callback:function(a){t.$set(t.form,"stock",a)},expression:"form.stock"}})],1),e("div",{staticClass:"col"},[e("q-input",{attrs:{filled:"",mask:"#####",label:"Berat",suffix:"gram",rules:[function(t){return t&&t>49||"Berat harus diisi min 50 gram"}]},model:{value:t.form.weight,callback:function(a){t.$set(t.form,"weight",a)},expression:"form.weight"}})],1)]),e("q-select",{staticClass:"q-pb-md",attrs:{filled:"",options:t.categories,label:"Kategori","emit-value":"","map-options":""},model:{value:t.form.category_id,callback:function(a){t.$set(t.form,"category_id",a)},expression:"form.category_id"}}),e("div",{staticClass:"q-mt-md q-mb-sm"},[e("label",{staticClass:"text-grey-7 q-pb-sm block",attrs:{for:"description"}},[t._v("Deskripsi")]),e("q-editor",{model:{value:t.form.description,callback:function(a){t.$set(t.form,"description",a)},expression:"form.description"}}),t.errors.description?e("div",{staticClass:"text-xs text-red"},[t._v(" "+t._s(t.errors.description[0]))]):t._e()],1),e("section",{staticClass:"q-my-md q-gutter-y-sm",attrs:{id:"image-section"}},[e("div",[e("q-btn",{staticClass:"mt-2 mr-2",attrs:{label:"Upload Gambar Produk",size:"sm",color:"primary",icon:"upload",type:"button"},on:{click:function(a){return a.preventDefault(),t.selectNewImage(a)}}}),e("input",{ref:"image",staticClass:"hidden",attrs:{type:"file",multiple:""},on:{change:t.updateImagePreview}})],1),e("q-list",{attrs:{separator:""}},[t._l(t.imagePreview,(function(a,i){return e("q-item",{key:i},[e("q-item-section",[e("img",{staticClass:"shadow-4 q-pa-xs bg-white",staticStyle:{width:"100px",height:"70px","object-fit":"cover"},attrs:{src:a}})]),e("q-item-section",{attrs:{side:""}},[e("q-btn",{attrs:{size:"sm",round:"",icon:"delete",glossy:"",color:"red"},on:{click:function(a){return a.preventDefault(),t.removeLocalImage(i)}}})],1)],1)})),t._l(t.oldImages,(function(a){return e("q-item",{key:a.id},[e("q-item-section",[e("img",{staticClass:"shadow-4 q-pa-xs bg-white",staticStyle:{width:"100px",height:"70px","object-fit":"cover"},attrs:{src:a.src}})]),e("q-item-section",{attrs:{side:""}},[e("q-btn",{attrs:{size:"sm",round:"",icon:"delete",glossy:"",color:"red"},on:{click:function(e){return e.preventDefault(),t.removeImage(a)}}})],1)],1)}))],2)],1)],1),t.form.variants.length?e("div",{attrs:{id:"variants"}},[e("div",{staticClass:"row items-center q-mt-xl q-pa-md q-gutter-x-md"},[e("div",{staticClass:"text-md2 text-weight-medium"},[t._v("Produk Variasi")]),e("q-btn",{attrs:{padding:"4px 8px",size:"13px",unelevated:"",color:"blue-6"},on:{click:t.handleAddVariant}},[e("q-icon",{attrs:{name:"edit"}}),e("span",[t._v("Edit")])],1)],1),t._l(t.form.variants,(function(a,i){return e("div",{key:i,staticClass:"q-pa-md bg-grey-2",staticStyle:{"min-height":"100px"}},t._l(a.variant_items,(function(r,n){return e("div",{key:n,staticClass:"q-mb-md"},[e("div",{staticClass:"text-md text-weight-medium q-pb-xs"},[t._v(t._s(a.variant_name)+" "+t._s(r.variant_item_label))]),e("q-list",{staticClass:"bg-grey-3 q-pa-sm"},t._l(r.variant_item_values,(function(r,s){return e("q-item",{key:s,staticClass:"q-pa-md bg-white q-mb-sm"},[e("q-item-section",[e("q-input",{attrs:{"stack-label":"",filled:"",square:"",required:"",dense:"",label:a.variant_item_name},model:{value:t.form.variants[i].variant_items[n].variant_item_values[s].item_label,callback:function(a){t.$set(t.form.variants[i].variant_items[n].variant_item_values[s],"item_label",a)},expression:"form.variants[varIndex].variant_items[itemIndex].variant_item_values[subItemIndex].item_label"}})],1),e("q-item-section",[e("q-input",{attrs:{"stack-label":"",filled:"",square:"",required:"",dense:"",label:"Additional Price",type:"number",min:"0"},model:{value:t.form.variants[i].variant_items[n].variant_item_values[s].additional_price,callback:function(a){t.$set(t.form.variants[i].variant_items[n].variant_item_values[s],"additional_price",a)},expression:"form.variants[varIndex].variant_items[itemIndex].variant_item_values[subItemIndex].additional_price"}})],1),e("q-item-section",[e("q-input",{attrs:{"stack-label":"",filled:"",square:"",required:"",dense:"",label:"Stok",type:"number",min:"0"},model:{value:t.form.variants[i].variant_items[n].variant_item_values[s].item_stock,callback:function(a){t.$set(t.form.variants[i].variant_items[n].variant_item_values[s],"item_stock",a)},expression:"form.variants[varIndex].variant_items[itemIndex].variant_item_values[subItemIndex].item_stock"}})],1)],1)})),1)],1)})),0)}))],2):t._e(),e("q-footer",[e("q-btn",{staticClass:"full-width",attrs:{type:"submit",loading:t.loading,label:"Simpan Data"}},[e("q-tooltip",{staticClass:"bg-accent"},[t._v("Simpan Data")])],1)],1)],1),e("q-dialog",{attrs:{persistent:"",maximized:"",seamless:"","transition-show":"slide-up","transition-hide":"slide-down"},model:{value:t.variantModalForm,callback:function(a){t.variantModalForm=a},expression:"variantModalForm"}},[e("product-variant-form",{attrs:{props:t.form.variants},on:{onSubmitForm:t.onSubmitForm,onClose:function(a){t.variantModalForm=!1}}})],1)],1)},r=[],n=e("ded3"),s=e.n(n),l=(e("a4d3"),e("e01a"),e("4de4"),e("2f62")),o=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("q-card",{staticClass:"max-width bg-white",class:{"flex flex-center":!t.variants.length},attrs:{flat:"",square:""}},[e("q-header",{staticClass:"max-width"},[e("q-toolbar",[e("q-toolbar-title",[t._v("Produk Variasi")]),e("div",{staticClass:"q-gutter-x-sm"},[e("q-btn",{attrs:{unelevated:"",label:"Simpan",icon:"save"},on:{click:function(a){return t.$emit("onSubmitForm",t.variants)}}}),e("q-btn",{attrs:{unelevated:"",label:"Batal",icon:"close"},on:{click:function(a){return t.$emit("onClose")}}})],1)],1)],1),e("q-form",{staticClass:"q-pt-xl",on:{submit:function(a){return a.preventDefault(),t.submit(a)}}},[t.variants.length?e("div",{staticClass:"q-pb-xl",staticStyle:{"min-height":"200px"},attrs:{id:"variants"}},t._l(t.variants,(function(a,i){return e("div",{key:i,staticClass:"q-pa-md"},[e("div",{staticClass:"row items-center justify-between"},[e("div",{staticClass:"row items-center q-gutter-x-sm"},[e("div",{staticClass:"text-md2 text-weight-medium"},[t._v("Varian "+t._s(a.variant_name)+" ")]),e("q-btn",{attrs:{"no-caps":"",padding:"4px 8px",unelevated:"",size:"13px",color:"primary"},on:{click:function(a){return t.handleAddVariantItem(i)}}},[e("q-icon",{attrs:{name:"add"}}),e("span",[t._v(t._s("Varian "+a.variant_name))])],1)],1),e("div",{staticClass:"q-gutter-x-sm"},[e("q-btn",{attrs:{flat:"",round:"",dense:"",icon:"close",unelevated:"",color:"red-6"},on:{click:function(a){return t.handleRemoveVariant(i)}}})],1)]),t._l(a.variant_items,(function(r,n){return e("div",{key:n,staticClass:"bg-grey-2 q-mt-md q-pa-sm"},[e("div",{staticClass:"row justify-between items-center q-pa-xs "},[e("div",{staticClass:"text-md2 text-weight-medium"},[t._v(t._s(a.variant_name)+" "+t._s(r.variant_item_label))]),e("div",{staticClass:"q-gutter-x-sm"},[e("q-btn",{attrs:{"no-caps":"",padding:"4px 8px",unelevated:"",size:"12px",color:"blue-6"},on:{click:function(a){return t.handleAddVariantValue(i,n)}}},[e("q-icon",{attrs:{name:"add"}}),e("span",[t._v("Tambah "+t._s(a.variant_item_name))])],1)],1)]),e("q-list",{staticClass:"bg-white q-pa-sm"},t._l(r.variant_item_values,(function(r,s){return e("q-item",{key:s,staticClass:"q-pa-sm"},[e("q-item-section",[e("q-input",{attrs:{"stack-label":"",filled:"",square:"",required:"",dense:"",label:a.variant_item_name},model:{value:t.variants[i].variant_items[n].variant_item_values[s].item_label,callback:function(a){t.$set(t.variants[i].variant_items[n].variant_item_values[s],"item_label",a)},expression:"variants[varIndex].variant_items[itemIndex].variant_item_values[subItemIndex].item_label"}})],1),e("q-item-section",[e("q-input",{attrs:{"stack-label":"",filled:"",square:"",required:"",dense:"",label:"Additional Price",type:"number",min:"0"},model:{value:t.variants[i].variant_items[n].variant_item_values[s].additional_price,callback:function(a){t.$set(t.variants[i].variant_items[n].variant_item_values[s],"additional_price",a)},expression:"variants[varIndex].variant_items[itemIndex].variant_item_values[subItemIndex].additional_price"}})],1),e("q-item-section",[e("q-input",{attrs:{"stack-label":"",filled:"",square:"",required:"",dense:"",label:"Stok",type:"number",min:"0"},model:{value:t.variants[i].variant_items[n].variant_item_values[s].item_stock,callback:function(a){t.$set(t.variants[i].variant_items[n].variant_item_values[s],"item_stock",a)},expression:"variants[varIndex].variant_items[itemIndex].variant_item_values[subItemIndex].item_stock"}})],1),e("q-item-section",{attrs:{side:""}},[e("q-btn",{attrs:{flat:"",icon:"close",unelevated:"",dense:"",round:"",color:"red-6"},on:{click:function(a){return t.handleRemoveVariantValue(i,n,s)}}})],1)],1)})),1)],1)}))],2)})),0):t._e()]),t.variants.length?t._e():e("div",{staticClass:"text-center q-gutter-y-sm"},[e("div",{staticClass:"text-md"},[t._v("Tidak ada produk variasi")]),e("q-btn",{attrs:{label:"Tambah Produk Variasi",color:"primary",unelevated:""},on:{click:t.handleAddVariant}})],1),e("q-dialog",{model:{value:t.variantModal,callback:function(a){t.variantModal=a},expression:"variantModal"}},[e("q-card",{staticClass:"card-medium"},[e("q-form",{on:{submit:function(a){return a.preventDefault(),t.addVariant(a)}}},[e("div",{staticClass:"card-heading"},[t._v("Tambah Produk Varian")]),e("q-card-section",[e("q-input",{attrs:{required:"",label:"Nama Varian",hint:"contoh: Warna"},model:{value:t.tempVariant,callback:function(a){t.tempVariant=a},expression:"tempVariant"}}),e("q-input",{attrs:{required:"",label:"Nama Sub Varian",hint:"contoh: Ukuran"},model:{value:t.tempVariantItem,callback:function(a){t.tempVariantItem=a},expression:"tempVariantItem"}}),e("div",{staticClass:"row justify-end q-mt-md q-gutter-x-sm"},[e("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{type:"button",label:"Batal",unelevated:"",color:"primary",outline:""}}),e("q-btn",{attrs:{type:"submit",label:"Tambah",unelevated:"",color:"primary"}})],1)],1)],1)],1)],1),e("q-dialog",{model:{value:t.variantItemModal,callback:function(a){t.variantItemModal=a},expression:"variantItemModal"}},[e("q-card",{staticClass:"card-medium"},[e("q-form",{on:{submit:function(a){return a.preventDefault(),t.addVariantItem(a)}}},[e("div",{staticClass:"card-heading"},[t._v("Tambah varian "+t._s(t.variantSelectedLabel))]),e("q-card-section",[e("q-input",{attrs:{label:t.variantSelectedLabel,required:""},model:{value:t.tempVarianItem,callback:function(a){t.tempVarianItem=a},expression:"tempVarianItem"}}),e("q-input",{attrs:{label:t.variantItemSelectedLabel,required:""},model:{value:t.tempVarianValue,callback:function(a){t.tempVarianValue=a},expression:"tempVarianValue"}}),e("div",{staticClass:"text-sm text-grey-7 q-pt-sm"},[t._v(t._s(t.variantItemSelectedLabel)+" untuk varian "+t._s(t.variantSelectedLabel)+", gunakan tanda koma (,) untuk multiple varian")]),e("div",{staticClass:"row justify-end q-mt-md q-gutter-x-sm"},[e("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{type:"button",label:"Batal",unelevated:"",color:"primary",outline:""}}),e("q-btn",{attrs:{type:"submit",label:"Tambah",unelevated:"",color:"primary"}})],1)],1)],1)],1)],1)],1)},m=[],d=(e("a434"),e("ac1f"),e("1276"),e("159b"),e("498a"),e("7db0"),{name:"VariationForm",props:["props"],data:function(){return{variants:this.props||[],variantModal:!1,tempVariant:"",tempVariantItem:"",tempVarianValue:"",variantItemModal:!1,tempVarianItem:"",variantSelectedIndex:null}},methods:{handleRemoveVariant:function(t){this.variants.splice(t,1)},handleRemoveVariantItem:function(t,a){this.variants[t].variant_items.splice(a,1)},handleRemoveVariantValue:function(t,a,e){this.variants[t].variant_items[a].variant_item_values.splice(e,1),this.variants[t].variant_items[a].variant_item_values.length<1&&this.variants[t].variant_items.splice(a,1)},handleAddVariantValue:function(t,a){this.variants[t].variant_items[a].variant_item_values.push({item_sku:this.getSku(),item_label:"",additional_price:0,item_stock:0})},handleAddVariant:function(){this.tempVariant="",this.tempVariantItem="",this.variantModal=!0},handleAddVariantItem:function(t){this.tempVariant="",this.tempVariantItem="",this.tempVarianValue="",this.variantItemModal=!0,this.variantSelectedIndex=t},addVariant:function(){var t={variant_name:this.tempVariant,variant_item_name:this.tempVariantItem,variant_items:[]};this.variants.push(t),this.tempVariant="",this.tempVariantItem="",this.tempVarianValue="",this.variantModal=!1},addVariantItem:function(){var t=this,a={variant_item_label:this.tempVarianItem,variant_item_values:[]},e=this.tempVarianValue.split(",");e.forEach((function(e){a.variant_item_values.push({item_sku:t.getSku(),item_label:e.trim(),additional_price:0,item_stock:0})})),this.variants[this.variantSelectedIndex].variant_items.push(a),this.variantSelectedIndex=null,this.tempVarianItem="",this.variantItemModal=!1},getSku:function(){for(var t="ABCDEFGHIJKL9MNOPQRST8UVWXYZabcdeAfghijklmnopqZrstuvwxyz01T2343567hD89",a="VAR",e=0;e<17;e++)a+=t.charAt(Math.floor(Math.random()*t.length));return a}},computed:{variantItemSelected:function(){var t=this;return""!=this.variantSelectedIndex||null!=this.variantSelectedIndex?this.variants.find((function(a,e){return e==t.variantSelectedIndex})):null},variantSelectedLabel:function(){return this.variantItemSelected?this.variantItemSelected.variant_name:""},variantItemSelectedLabel:function(){return this.variantItemSelected?this.variantItemSelected.variant_item_name:""}}}),c=d,u=e("2877"),v=e("f09f"),p=e("e359"),f=e("65c6"),h=e("6ac5"),_=e("9c40"),b=e("0378"),g=e("0016"),q=e("1c1c"),x=e("66e5"),k=e("4074"),I=e("27f9"),V=e("24e8"),y=e("a370"),w=e("7f67"),C=e("eebe"),S=e.n(C),Q=Object(u["a"])(c,o,m,!1,null,null,null),P=Q.exports;S()(Q,"components",{QCard:v["a"],QHeader:p["a"],QToolbar:f["a"],QToolbarTitle:h["a"],QBtn:_["a"],QForm:b["a"],QIcon:g["a"],QList:q["a"],QItem:x["a"],QItemSection:k["a"],QInput:I["a"],QDialog:V["a"],QCardSection:y["a"]}),S()(Q,"directives",{ClosePopup:w["a"]});var M={name:"ProductFormEdit",components:{ProductVariantForm:P},data:function(){return{requiredRules:[function(t){return t&&t.length>0||"Field harus diisi."}],product:null,form:{id:"",title:"",price:"",weight:"",stock:"",category_id:"",description:"",variants:[],images:[],del_images:[],del_variant_ids:[],del_variant_item_ids:[],del_variant_value_ids:[]},imagePreview:[],oldImages:[],variantModalForm:!1}},computed:{errors:function(){return this.$store.state.errors},loading:function(){return this.$store.state.loading},categories:function(){return this.$store.getters["category/getValueOptions"]}},methods:s()(s()(s()({},Object(l["b"])("product",["productUpdate","getProductById"])),Object(l["b"])("category",["getCategories"])),{},{onSubmitForm:function(t){this.form.variants=t,this.variantModalForm=!1},handleAddVariant:function(){this.variantModalForm=!0},submit:function(){var t=new FormData;t.append("id",this.form.id),t.append("title",this.form.title),t.append("price",this.form.price),t.append("weight",this.form.weight),t.append("stock",this.form.stock),t.append("description",this.form.description),this.form.category_id&&t.append("category_id",this.form.category_id),this.form.variants.length&&t.append("variants",JSON.stringify(this.form.variants));for(var a=0;a<this.form.images.length;a++){var e=this.form.images[a];t.append("images["+a+"]",e)}if(this.form.images.length>0)for(a=0;a<this.form.images.length;a++){var i=this.form.images[a];t.append("images["+a+"]",i)}if(this.form.del_images.length>0)for(a=0;a<this.form.del_images.length;a++){var r=this.form.del_images[a];t.append("del_images["+a+"]",r)}this.productUpdate(t)},selectNewImage:function(){this.$refs.image.click()},updateImagePreview:function(){for(var t=this,a=this.$refs.image.files,e=0;e<a.length;e++){this.form.images.push(a[e]);var i=new FileReader;i.onload=function(a){t.imagePreview.push(a.target.result)},i.readAsDataURL(a[e])}},removeLocalImage:function(t){this.imagePreview=this.imagePreview.filter((function(a,e){return e!==t})),this.form.images=this.form.images.filter((function(a,e){return e!==t}))},removeImage:function(t){this.oldImages=this.oldImages.filter((function(a){return a.id!==t.id})),this.form.del_images.push(t.filename)},setData:function(){this.form.id=this.product.id,this.form.title=this.product.title,this.form.price=this.product.price,this.form.weight=this.product.weight,this.form.stock=this.product.stock,this.form.category_id=this.product.category_id,this.form.description=this.product.description,this.form.variants=this.product.variants,this.oldImages=this.product.assets}}),mounted:function(){var t=this;this.getProductById(this.$route.params.id).then((function(a){t.product=a.data.results,t.setData()})),this.categories.length||this.getCategories()}},$=M,F=e("9989"),D=e("ddd8"),A=e("d66b"),T=e("7ff0"),L=e("05c0"),R=e("2eeb"),j=Object(u["a"])($,i,r,!1,null,null,null);a["default"]=j.exports;S()(j,"components",{QPage:F["a"],QHeader:p["a"],QToolbar:f["a"],QBtn:_["a"],QToolbarTitle:h["a"],QForm:b["a"],QInput:I["a"],QSelect:D["a"],QEditor:A["a"],QList:q["a"],QItem:x["a"],QItemSection:k["a"],QIcon:g["a"],QFooter:T["a"],QTooltip:L["a"],QDialog:V["a"]}),S()(j,"directives",{GoBack:R["a"]})}}]);